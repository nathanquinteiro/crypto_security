###### Exercise 1
C1=[4526426183265351371643448693709001430559739380450073895635080539018907916348294559214243698018739502361585983319576803769978128909696663154899943140658072441237507617194573687834812863546265934086514608343023581887348292365665438482157637825480261746771373356668247404711801336215396844438735421559838659836728351132958069436677411220776506494063456680900375499221903716864619548454500401648925142492476584996245875721573037179491496070600809229350965513017035572245843621965174786177892738502677335682334496670073525010504942089801007755027488770726807183955830385018399703881086269101126681163840942736279448846651, 7488232382490267675319592345596084466945697682620648149346701684279837797325705904002110269170275975194475735796741446475398337399692528851484627914076852263185777841070746851020750137885094272646269297207091171019694466454852035266595905175064247160336599952037681514412735656834541870599741969262877236365231593830989125821180112799126995173377891500449934554955898326100779535043738272057763599286933732497656679987102007594231275823911973338439711156191994708913765222735852544817830720129766054913570660220669492391142942401346836594415932576135980144860199644976309164356206256369639839715255519095580941532421, 8791459524629760243426192078357794246224532223324603147666034863980934872701166900273665445352874342507900779376666320671636289493534007520708288096151408433617134166674568549908473315545113373968190807879684960994151926192993540310303419813366704541860857431804549780153742016887602187812960156669344454542422794303154271524446000890469134124970078160525389386067673393533276660949167270915206532878186502052488538474269221594294795658910106160220181388582730611967278193757633264637486581735531251745661624837059626797575543288293359402787368398386903563737590768797584148687962570654202213036730019491340318335848, 4061518625050018451432359643173388502948887284722733073105400447548483386114031050707072137617224841625793830003221584425794741102133604789322564175649020566494924119427950178413557545154268915360646531480153463472519229622611616877100960701524696676032486045799335330471379833832714330072180165373829083156298518008069576288443910383839533394404517373730446985908953553524496521018217446857256518952957528069907747059249429796392634545627290444188907788241053597100164206594879021694171092514627994142237818516344886011565331177567745857020221829039947280587942018996155655913893715037088393795872715415911445411817, 4176066069464448426563108877119346159786997002125845994243148291533974611414224230861471381960589976820336911133309920249095302119902023003697625743357760389045044864735918809868361960251570386752275603653275443555830800073483552525450469511463948191822617828579937001471028816667835110249461334177407269707276080791216125613917854267903602030856509827792311378667304384917236412415128706493440502596493481360511808589255609403499960742164150599270647948797607524185607778647224911145462671613539074983664891357376818405510351845030030292770554540499096957016097641929225021029039695065222798498563432013774137482734, 6842670138724917616454027464995654869462691410986655560264050945279923926360364589027866148022225586124638424807176478542125651098910658365338129665459798857359638192839544551188729691817971553908277764605505897091212705259656419739158320383601655440198769465415657244688868732926589633231335792739146008628024233035114992932198036718979307925795819553530907372138670579166661373065875726607225884840661992085530810694694509265551844072793676649952931598631359444489308219331869726100397348703123350228641852079096362030436018015426340392329471346197714671669271754129268165993993003141934508912634573769532416924842, 253549801622064322500336666711120089663679092498531671265780598916356305961035268131308958420637333916378581053877282031459588109383049044779155558654589764746735871036242454749775276078699491253571901013372842207360121022284131680852193736253330504306115529634515245030774602603722843587269287419593189819422407928548034137767533849706162662784318870115415274799665916010075030850054894225565058628509209182800158937044308268527601047731357034179528268152371989430843169978467374601266091001364263915233581677366308484068998237941109527163476746753215440783539442636435807954308526331075991891138154343151611937488, 3139987596430570627540447085142980141895636139961538944530680656625128450966434894203204613102810542558609370929436202172086482405557451374922203794264459340492674914027001043416229436101131537536091752794702073135768305512741356055618095050827525776604380110849673251726180387153754031487368586919310069967177267662306239017060253358803045417528698988171445047190038674577947184342266532294772087315571718155259987328123377013644434607044021325045677322750385468318749711384631995388395798077585470096621817057075674571398738793119614586854147898440218028548270447184696823192694284973873884262997283081202436465995, 5070903306418183441050049391348159312029185232130190753200525564863176939453683082501516436167961778808249471797969502928211594071269566225213238236447192609058036998840122965927324523456345560001114552779425529963425791770370955118115355847746316590293779979724431354196326533024115529790318710694144192956814459469881879106250355317358917489099815982102863959572376327783492679194235752364507403724930252585169389201083959222551164868527494930094546986661953722832659666531249352144556201956999119652695484153940496819315760144025686777675929357121280693705909916218921098751732667391732197889625104419004983378541, 7237932726869803011158285317536004385265906706808159191141814079928356875213960112658719050830416589536945991955606886328951262098252426505671949862212987748709938203953738126196928563461176431773131189885972036669189983213901792809612972225455084026583846095998518458004975499090755719912966771346877858120835900332749063647652134258220110799014475525822069388255642542859516556379833255133294165679025169742397266376523987186360191100818513798877140667903614774935239417266911657912896758654619315902309352944934892376343876900058528918417690518979941166865116433651930825222588075212210079526751133795175936359785, 8791459524629760243426192078357794246224532223324603147666034863980934872701166900273665445352874342507900779376666320671636289493534007520708288096151408433617134166674568549908473315545113373968190807879684960994151926192993540310303419813366704541860857431804549780153742016887602187812960156669344454542422794303154271524446000890469134124970078160525389386067673393533276660949167270915206532878186502052488538474269221594294795658910106160220181388582730611967278193757633264637486581735531251745661624837059626797575543288293359402787368398386903563737590768797584148687962570654202213036730019491340318335848, 8270714087436272851482746254029750895494550799444975440342811277411981662256773295203775793222826406087652934237916107822945795941126711518111487813760048722218180196157616551947599164976034037529986229445084175594214982424565174212980843020675820247017728331185840737816864908255813505827922936706556305735110687509363348770245712612611276799277515538278348896773993009816629824789186889318197516126383018208948145728245484327154347350588236582350632917365898983454149574499123654804245503117236997577166484799771119274144449364245085188288715243889506909623743222990032598593511225391128041181470271064122423829070, 7637410181362867118232568622950488236241386422320129238073813208967667870045775422154307372577774042122661474136844381634448314503896568199016745531633997984153735981704755796890946978135479136160710990376620921591375439096233703524319545475168972831347504424502810626503292617315104904130683586877109990138942964195961726585547482162223559778571442119240766763796987376740366070314392100169618621111804645015174347010347141125879503056546314792252181274139955964638304035954771870481095391590998933589997307403966146541129037099871159512099749934341274858561725766307788963144522816660400066508899505150146381928472, 9568032331959676736693411049715767810828911530737855882348861964603886817542815470739664592941538729813218649617705961526350888705494934973395835871099123985948722972591389563259548381858513228769516636336423036695462830554770618964768438726439398069408282236128634723209785547794061369381199700044994639328448027246331119369941778300931568613703481655438757076925820457999081045014697096258238098592035906551305540610971387461437432110510540307857699322845811774134489263227275326690781334957592056603115383518712741849436314724026358968512043080117376936634750515363438175666813412367733075361655240552254647932678, 7917912813092542604958817807423160869237263992105248288510293978206097821899959164430109157319500491167614382901039169093746917260435701705572617080183335342251415919661045304764347138194065169585118924226066494048129886241977023230504171214527519604683317298888071125804416745573650223593889233146281000354241521344759137461066367049786305747862234656144630545601684978669865059039242108675602539112417172245743715556494576271022142952299282582118633592470368263544061480845490437025331151427426004537844188546880641565519363813633074636829574546697563952778885886024385731891393828654167851898456497836755560048908, 9346637075030968153597802528421569287949398539792926558844743747594616330140071400088429572825867582892959498766471827101764468742944248660966129322843983965187454972664354999270065416283915267010732762250384790954353003485855559526746467936896616935380488985380470191377255779485922082133674201446384362350096059237418495331595866099992923687413552608403569497277524088511855749600972524478738707228685924496014860875116946635233530723980416394800986908399802055539622184772339221556158435190870794683929267190155448390981116332916433613417038678169650128443509241231751797929098254367160769433232039453858941657780, 790965193764167476925095370779103066909904244751890773266338783714875354732947207138844174047605997105115712085681605646093329822875174928231699528444079017327543338246073979078611344199845429451955175084166156693915125909938367627160881263486682905759840632625687325070201343102786601433819686728199073875864793785960812683311585092608367769242679793481686549319857513169242465417120514280117056168283386145584613911540450282917219851056188878539974123774876266928562950173504893678035884842715612944378866243665657624109109282739138659209136748678772312080746719028208914923186557603243187888013974812351605200252, 957071940892760626884519397880837377709393420098423145417183105437764189817845728710787931434847503110472785935869522626425577439220311217560291652461091685135421749628429052834299178698860291844389764416760845741770671800744184191112721168430335646060455223748627424701240314604623885780728383517923570970272398584932554296134230984813824665892819345646283593848787241786521376708399123079521502438971619654590417585169385939405460015600578499435087678225933809885384878584482583782897162446859267084554571473213913926809559455756081429799576635880799766418194262542382204038065954900367664843869678648454471281551, 253549801622064322500336666711120089663679092498531671265780598916356305961035268131308958420637333916378581053877282031459588109383049044779155558654589764746735871036242454749775276078699491253571901013372842207360121022284131680852193736253330504306115529634515245030774602603722843587269287419593189819422407928548034137767533849706162662784318870115415274799665916010075030850054894225565058628509209182800158937044308268527601047731357034179528268152371989430843169978467374601266091001364263915233581677366308484068998237941109527163476746753215440783539442636435807954308526331075991891138154343151611937488, 862189194650447213939938258024805367909646863745283393074199776085885386089342087388174547876457849516031741617723292779846055284255673800145164640066086873642353608433602154044497668799724875808344902916320651252037552156872798240962033487149467966726819461669761547250710865662349093228865031217950950894230021123008627782017864582719296706288866576624258831595715391113099580802745492201122221880561356928814934691958967992924712518956147709460573250032121829584533374305078863322829816741799349345514800548228185765107631516419921201777985266684996331171853318300989961446721569925142160413503543941472736582980, 4865440846990419824106587973005582354138094116556551961152641359800450419675483158296293044028930790363403027313507406915542245571420127330155847137002241352028619337899021734911685890059205275167676847190564024271795812052612297796263909712110750029138927382568465600878476679493205950008433414462194103654172754456085600095428966046688038475165395867250953534134517558417456633940762223696188054961848699383517171965197310115845318771345894131755241070014012226833558628879038934326215286316709192977700633001712974724465063603175022237385705882484042030161683498075238298570957764004539324774897272738343558882909, 4346673545000077115767696174287873245243050716899553552304634049309960954460040111339121754244114786415405426860182531815150398086652814336568261716821276532972458218025701662056484051214149636451394306526879558818634494402359582699298544196133117857445199491193836106392885039322024235585408283041597684256353521602667556008268673876941048456585871219440692043932824904196175570490741096943185784055413718404649912248388753447983359235735271070665365999213547712573068845483618401286548861082004126269964051669851984475562952992700623551737516332166713927683025469625018944088119981408736891371604218609807759691142, 9537720746721388270780482109513439432923596056350190876346685863236998113969686039206320714190760951954746261214608996297962395470660405917216905207146536130173003462772135220485857212776646249977421429309091050110715083551647962829176011667750220234817702361538150716951351817757281222289807120204784521699465509840018594640759184128241511620494058016529358183362549271268966954678048250485332793167769454309747416955260532654561756099543373409205295269236300417713213311268502050030845470618705817660340340576353843179802857188992410607595115002094505307467350434476813390473066009628111469793964460683577351534948, 6892183279857935324774822990914407188076788323142918403492447633988836666063264126857110261790419802590323234124301909071134571336617936945759462495984631413798250695668393105278366243195655006731341238386367558057927663821146601083886785793733282344077789448453436830428684889751735830827772902528039590498136459300047049847793695238210197993034449513050227106364483049782222675667854263121956727015364678769961806355131272476208417225718795613714152122218676548395118949570752778284915819484676622750993845303348568719548900193174796170359926602860566883332943588950423437499011742975773467177092510064386489302729, 1485656105153207097339949701561154489559989629073954828872778411995612672382199754993587424935307411332210474474036314304276316281276648268169043404504085551977371823412429171222128900988914273532812310126163857394320754036751780242998189403708225202373028715923332596683530225652533017557810996465297614098060173407351092611478221634267887497263218071608350040302092925472484881042267092526571635860646134523267710609154041051529838935873378862116367154239116684926724556632441582538793708278533612324695330695410619528819076050584753447281128108984070062660963913266467305363826089751777124402118689134372000087923, 9148006598887789304838426682129220102179778527410061169368290789946351466664892107996232725169517434389590387723912114393231958486803251112609465362990327137711921481828840928643926185761401568375538855226652026844809929008846139504227723741964166871453903379242652561496033764311807842677712305997134128929412471453445178935758919294280771683822760080500335720616024404073391399623539284402021825500807205995575684479095117602105510752734195136942684837213066725028603715397228523822964077205315369261533375602772009345034051821096632161600378560639071485458382646855301500702491753502500866290530207059610327913084, 7568577387792912998729415532936910648994818464222662457168894981942745113657165780634141868571660615869495755474430196384865342367015813940936379895786015704828974932096014344014871652086970764040626062439096032715721780082873890858303627121967640205656863750835279931023226894074919405008618793663898887246153626629352603192552292580566183231247836024902329202399234236120874331099130283646159457336187772695419131180589377175714603627530488217042366070891949910372414956280760310688559340048908598409509530293260093846398619153010181666264188706211610286961450984432617358630687966242855717494883004011242471808210, 8763596156361985319099526875275396087059010822694521880172317711205526900634216722410026396230053110141612982207666501657575290143455351884853717418313389154079335693325782439989534313352770642709439782630315421452911094422978689302351034944697168182163138244991179246986492729795876725236726153681985670824988543000565253285485913740468206415045447211523415999567431940661526664372302288689212388388260331219229882596261763835393726391879875102492226568669965796749504997566481868187366840691323462067155625754610208108903891974381771875014354643258700742545899184489638348115189028261265465246536679103627478093653, 7255537980255456222312696200293281062177362482046669572648271593757230174335747737191157935287671715643317713729947755205412367033902203501037730133477229586592919702177938936622101195167828144674813672401106405023888055096051027525901148234347211091709845427021379974612059157483057398903563366681105976504459438117954407274260913807682764255502203860674613927968887736467743199746527955653625472887822006310492194369460280856477272857125177041722004590089330980712996402287230072401568415919657576824703440025794850759770658711818226754902578592947876459809774304440634723246019942638542462296148468466982932834490, 7852426225143458476374333395037736797459244188465844267149655582083705801056534501865530318071918790787333969786216527579886973612340489271308626521952701465613714489206535449027110834889368033134580665333520256798220694907242992364573312149132435106704540756363529713446909916136664604695693797944571264157472829278138825443047621955107572749266875356521637273695325346032046208773279750773686030268753970603087171290651989277778105321530441633971732534521859291162586825004266767559607168026512799871170877229413798933235830209765640368463364390051144246246047377384294751633496116958684433478896460025079566795664, 6195115223057959414954241564228665853558637480970083793391838225012661554294032248561786323950788207554231873926596721144311082571485582463843595848140493376973563975913430458300419339702343278250461572691362956849423375667146401907199543530851201248626436451380266043230810296103292497436705492629077234762729051343116883956465738590008137046360717466303762938696584418898601072459756684773331453092891217469335040567682786105342047295281098920659986538059032041351593113048220949803239031478849225952575985029854637671071342972727938138323811146818658976543504505637279464864509160474357265754692238761607244964674, 6622246068841190391053516913218559660197925736855552752328905614431809339191469554470906723888288888920030123979062154602534798243822733749031752034379382052483460206166545503099014965793567717440234881461941828564681986858373378595138776742995887220942364217368937893357750866205051227481916145163252698416952003642493532206929988815321793921412948049594916455790441482846034008137238083365976837314742929945286001962233558974261494299749757546217503527620210757435962506351904603428137358417947494209252228160408160726199582767261458836864992210821994700399279653463393563431756458637980470199692917900159665998172, 253549801622064322500336666711120089663679092498531671265780598916356305961035268131308958420637333916378581053877282031459588109383049044779155558654589764746735871036242454749775276078699491253571901013372842207360121022284131680852193736253330504306115529634515245030774602603722843587269287419593189819422407928548034137767533849706162662784318870115415274799665916010075030850054894225565058628509209182800158937044308268527601047731357034179528268152371989430843169978467374601266091001364263915233581677366308484068998237941109527163476746753215440783539442636435807954308526331075991891138154343151611937488, 6399852539443781859449737282532502537023448045625575555422947770732955852360884159641754758521614589795657200442794099255228625194995143571077049371240105138111530380216288524282712876255522046606523371575425119340152310623359297663046506776268728002154971750241406019408668485276461418450918517922899425211700646716463737076301849185400887717891557110549569599452993895476524999101354924879509112084722229216107113650563452833611533513732219805532511944388165137692452093257532574014986137100504692574897103450694738940100045068517535368633951290249855419801069681519501979649325634892603331686333087095096024354622, 5328478166895613760877865157467141869063643846911042098147584778492950453223788326279775102224522591126069164308156360272411289418982585186639649362883321288916906644010468170387028466304162336404124250556154919137612830805797955523533559651234268637451181724873088496527563095112970025591726696837145056519670016729744906964342827262040905085607400950377916697673370600617818753604909429923934783628701202597044337609669459665155577462348155840153424723355838173501427734293817022592084922746297896412321654443760298151528137336605731407026118562144956008298497749710237118440581641201641097379451735198643297731163, 37866793754685313691527369064310640901923039305675530437846414904159898906007153194802723432783365120192076740435203790377155706035050804422167506934856639114435040136721678627119336949857364477933326273591125873925711754990401142569097122439401682053537933382426666625820009346428191902019254608383253987215324837625781530750901716035920727789772948401512582606471604458527522361716496221977432624907188312621688463788840145492107598346035350580308914215383536951826925639145503825459241806314042115453603332358335521715687700257061349289780499816646485613793644516353907495142451287982118298929169542316676412359, 685164242775968994536648034364896086464089770490786516875749598215169947609207338330433924624841711377352899600691809715073183200876852894356769030623861061347088671745313395030012822589923245679467574813786396102374491096147634268888628614378512161217628513522958984477408468926678032212223953459044315049617228044815469212095457183350702944347534443787260346536971878154155292672032016081564034254719294009875488691995223037452006971876100501181029958644153274117232608209015187195056384403514403469032463949154949213249060764836553047333768421634344882317189271973809718576312205802265733244594500473669132477410, 4811620611495387304897475182587713005414559237582611094520148355607685248027797319382789717263173108592637201962778859565122669770274880582536957760672098246362245220614254510020463413030721809963152824013248680296728624860428473952932348109038370777710671178277025597623789957892035583121124122044786034885214257056368778577657336723601281839153177495549916601283011025324530023266074107413072538041269454519007837852800793289209929372945901742672781206353818690884481656742210017400302881572689637380116509594100107938739143828268343992691199216421546555299979911977945542740012030695613269472282964389277716465634, 5070903306418183441050049391348159312029185232130190753200525564863176939453683082501516436167961778808249471797969502928211594071269566225213238236447192609058036998840122965927324523456345560001114552779425529963425791770370955118115355847746316590293779979724431354196326533024115529790318710694144192956814459469881879106250355317358917489099815982102863959572376327783492679194235752364507403724930252585169389201083959222551164868527494930094546986661953722832659666531249352144556201956999119652695484153940496819315760144025686777675929357121280693705909916218921098751732667391732197889625104419004983378541, 7242440078897102458576428674220057573150770205798991496087920158658220428688456159914234289963175904631928222908512893441452347844544030863517454925328884321313791116001639442672790212000698715220277446874858257650846808739663370797364992269704755179304668766001710574108720816531811828445405640615822357176180528477165511717222123699097201568682649150705122647655382335630147901069612380747706872265368377682198152783993492127537564983873223430774150716168635138213363074658014474926935862910804314141117217951060685298817812533832268382281151006138376737015812729213396384469834947991849884066540740104875929858079, 4956521102586868107910413011773227359989308122543971568891868924558130249326441561355008649887588411458208749464695693198912610372322515868145011333462174582710858999150447157587481350800845894109595077769259945492376716817113454256957584585836661900633770089544743856064874949756691545711312855950948263421970283484110603859186943945126691302392396066592564547017490964838688358438928918828701381577263495810668295405728667693330934382864730135792556852640185049169308297149628859721097125306672418132894977384214269512613590091533512872205108452982898267445245594200774206279520771170277818035032857688623690569577, 4944874905741079582189247279983906522802206679947074825645176248901143273255106310735342654688410565417120604380235746682369102340156336383221312609280876930804921017869319808234145897886154968816538365992924953900184964318230983936516555852151417689397306419314780899831488099814197348076951653723644752664493197402938480401762427182306102531197573573491179950788670185905173603175167217924175826133366707869778553901032585362411426767494898875048274324553787569726524721233928853336120255660356334829115110498376645214202525280369636235528938864474816803214808726626406944196988848785540152228908346739116986882135, 8920025283246378129545822395763580734655752275716234991987310431798424054174563988826497637069996124816631425380324139353103307918701897062679489011875017731008577661186992392321458017440799845982628166413037804428772317566423715790389916822656251637880299606906804596039541294845754371273939470779787885173536962010319669488918999822715960185357259161101424036822483386638010156878566624066713990544422115632391657166673192101193510030760346686508517858994186356470050147436956110596018547304191972729994833555711170315291153051016016335499742426955147022969208071672021756314972024134920950410476862001840666076109, 7136109262286725143682450787312976745398563097451526353032244859958880737592104271302889095331873214099871947642654556031646157670742072038923416738681173736132311493016616760762969616363286026670201327985886908765478789024219011880041069314245483769980106613863480949440401220678793866522074427590473326000076384022467731258375249490057664465369327595646666289518919844369452686657245045158820430984013618944353063215343566085729044550873005083001179675779548203418572968873334048496884597315340203621186598782521453401003954199614450203170219526975120375187851121716564824910046593891430590417415132485625508044535, 7343861832905328440468175636614415139375093599712740104174705716671105198579083233255424303488659140326116198996284588008386832258306739848685838996404214489118194199422364789359136143865911748498973257451830054394027903164091852089151786244315047923457161463483671539172264582697622967556036314487376865359411423509572236101274460350021217624151780973959872511879000701656402605052752187593820480045983551377844990866256704979529683325365924958514897882239692860606295451941991398053374434265442656617941058436368816030455115860507078366702234487864073249396004086162066335214020009556979356580749091116842548308712, 7392461648955641519651052631330207669271999163026564266131563580610917749374913198325527408060359989203258858610205690240581647680264078778457141014961905465668154632658823176115392976907828572809589029373557463951700830665974866341017446345735021098079865330461783484660646909421628773413934035256818712337784454055872556570843360925313814010091867901470149985967568305454699515813578241272789740343427656406753114609667835243939309169753317726686404543246203955735553689053909807432373170113318906561508141505612307512366029900184364695182728479329321203884515615859223844265115924675824250250518929133435016082671, 8957670155318691727541997223038821825512391854122424021622167345986848445115198243898378630034496410758528497189792732349623507915008335012171292183267539873894027087154066982914656766389524186788638374499107933743366205067733125607874222270571270176070647900469101910570347397653603587363885340911564179773275195669514685659331898778618125181536246967244916023486677388690943297946283661614083742351246627603273544925001260718014429983841940021147218552616444524373495453182623285424886108817170668166854222928377423052553110261016365967247309636415345260759893640406756447590473708693213895624538282621532134249001, 4674236464162270581546580125235599559937553610395350439013068033234314157287136280130400057274312442880755689832106968539916360188941676349794330120425325098831069694875124540780886633094781971141716840556022753798883521505373202896530716661504563375105910549494390429318864425241792674376188337403946683097038328044439160044500158486419450761508675135222332102653068938234733032461880294277087521784312260751997640160067510350136711394459088225535024433825297985276348194068811628096366695888351568579302349448026326264180963963804239405155858000721234678434453070124708536395072875029525243644749539528888591753607, 4852070824300614918977548261849874065544744162002768740873118121764301270707552811853644692530466587852882287234923085838141220083307088018010572823595750570981220064947561900520410229594201328864923572184068953935291563386883649787328966276303043757009142764031656666082801522034533590253853163154822196744463106612750190056696478848364521075843798244977025007082876113604838893171715177600679689015881313463649551370001234455804647978550307310238915567645296455008612897576823292973691387937097836691183072280592244268086859543032853947471835105814803746286484923040979609655933314181061496079963282992832967219474, 6734774001848078794626221813509320069675526009418623167281830432881194508155928032936795620024225860631230742133120813304389410066230244223821201459586312375188667790349473505221148988237083844323914440714016856523920194414376722742908248637513443722758509467234571685222485171385809520712069668250581748698205800637582509546722782840783114153499222444222886569600468392203085704476924339767851848463638190831389062135871647298488371577084376801074508335618890276069349835404802298892428294524292005267908739283873315350692733904682357207743502925241746908944823492765378601983226387707778709681762259004710780418983, 8286228018429091081682872060116414780050269652071122153081690722519865940776841689387386535326535013906764815224171175611302050038903289340162607195934535277164712630105465958417198330795102505619853804127265453746502925220982185483684821690349545771663276245222292605707057532539130233384922066444620854879839041187688811790145302519746233501837753674667115494979478151757144775918283388046351105889923673566042937627067055109311328875114642235552817331452071735627734956952352930065236039561316947313321351436863283298880756321084993489380080173546158400313310874075627831903939491537393470281679313106266231527569, 4526426183265351371643448693709001430559739380450073895635080539018907916348294559214243698018739502361585983319576803769978128909696663154899943140658072441237507617194573687834812863546265934086514608343023581887348292365665438482157637825480261746771373356668247404711801336215396844438735421559838659836728351132958069436677411220776506494063456680900375499221903716864619548454500401648925142492476584996245875721573037179491496070600809229350965513017035572245843621965174786177892738502677335682334496670073525010504942089801007755027488770726807183955830385018399703881086269101126681163840942736279448846651, 6496500989488880022294431895305683428637871889100879010293913089176614916134219424468910906953222821065146618808911587058525982626935448880652185210037481695480129154373679415194096359269305329727314841387722427287444350674878586889396842270623650276081663004149654490219737127828265865781285517596584091348909125305537770092396088700891766057964163790723570309623023730434500574016230058079650167861762464643561044835750899072082701492601378982135335943508336686038338523839415982051938627778282162677383069137715840837153235869733210658304852822952219216021703123432286948672439610000012121323838531308599468853967, 7539338172917690757001120180890852867506136324114843255372132089351652638889481744674282202926335299844451969585550783514456566558505328526199305911635356876530685048110118342408732576074187328089331901981742678321454165639929767752013025416344593170313641666268577155641680039597996064214032443001072172137241051828309882997808102321207540008951053636829703449874516129486552614436267064063595473453639629640629418188190870295330215140587884589213519290261662375033805661244859864984415670239696772830374738378225200453443388499242435719359665816424076477233740746052159236753524642763836009985269990880529837018287, 957071940892760626884519397880837377709393420098423145417183105437764189817845728710787931434847503110472785935869522626425577439220311217560291652461091685135421749628429052834299178698860291844389764416760845741770671800744184191112721168430335646060455223748627424701240314604623885780728383517923570970272398584932554296134230984813824665892819345646283593848787241786521376708399123079521502438971619654590417585169385939405460015600578499435087678225933809885384878584482583782897162446859267084554571473213913926809559455756081429799576635880799766418194262542382204038065954900367664843869678648454471281551, 6078893122148250084359786206590427000074005175486591037721112298434887353476216315441650417445333239233520863024643729947939991987821525007833873909705419334668548823872066950368292797407461460166529587516761674727161613050295556426883241673250064632366040466828962496304171916821585909735609610955013248822461129765343135419515512909057906304354839359842858572630815347991087591654441696175562461392086696158659969039940149824338652561829493900218508480308149993913847332255447428781731754874497919899963196025548240342194143935065428555601524661611473499910926952449327387213697317775912519117234515640142881698540, 3572524214106213944462811945023657519527012334646360890381788103458148317656633636094982244101346331581474837489724637181248669690115913966114473131523227276238318284964994388508124538359394448682403168647642223828937270135839938144697346750329575296588471449106498699928877415158214325122848634672045853956018786625408173545762909909876844790455925842570647718578507428611333061328807188591256847577528790011623258054226697887679980803451887903106104147404122439189692702548226319644773970181113071338999147921592013246436067314810085414245997137398790271141386671521873402155564732410646678186172709866076911790587, 2815999394264950254085405690921028036431574194881587976746255886513049644343631295341443221459673416785547536785587075013535543293836676189322223231589433058209835225937618239763033251097608199826863209136923474506260427042969022076342224852148384857445067242128059705112618875047193246537787267598762659306556936640884926053695890298087695399897247335477366971641778926621951581502857694820426760866453054509952370772633943339560752286778313439099498882319409970624502441893039438542334188638246819272571071784885022385044580626202364004588275333910235611864489431893830630029954228572344417679381993200430955502631, 3133231223059103994524999110235393961504620003152227031448202916037796095774337351385854755606183244597079871444654647446917020615925453974590202306645898896967677907065552814525387220968190642145114320425264468485705563583246353912646657318342392593265827008413064236992443667289950625743437793701622390278065752864891528011740234357041973575586520464194427007596033445589847464753444340913594233350403851660298985834615049873686581983687883686949304891924323426177837301515607552189879108224037441513109606416207186151124266006587700380264538803384685449309176988087050495576212048175179199362822986876015256334083, 3551615953511034514794832391914110893533440571973241596297307563969276115977883911403002005643543211524942837551228464788460070954563694966025664189814625146323482788843693592090996609561054942767982557195651230280250704864990581206997335270218448432290001186585727182731993472836078245615594641787524368636252116602748088186987496019867680375706063348080068183696165019151010393812227068049883734564230533008151543426249202657362182808647720896205360404553690391647039607781963446253617491957128537480633113922730787787215756067209015537223787855002918758164618872554437937252490944802220228145644796760382321391651, 1794862025585117110481325679119551961747180999304352323852944718827142034743535431922990308567689786589058172836384328172868884523224167624434538562718410337338803320073601870807587445861585581633218367751641117953643482923600154528052747563325103341615885240131838309914514701544755644652193601175271039684363812127851002749618313777346112697796212492716871396995144764518346230151682592460956674303128496529525879986615415152842262808119556921353624811879508257452717734186934630304453086540677037069239058024934721670803896199547809255151574520813294705739698320521384505134305092684618893261614425117992235940659, 173790002919004384307201449018414258419294401693510513581717126839189451237954985816730726356151223963826667363895180723667604109519328792464469426955134185200203973455588416238688808114674992947375136873422268137371226216603514371760253396833804984455235008878133488851284645076088926563358871673673228240748986388928572491965210835538540584752903086474641370363585643798504795998116276086922736105433744076103940415079468920972220954036520138647668173232148773873636611476499328966852462896895764469507205567038445931251072237380439829003909173062182216684426623243751012214986519687898209014565985456432809877043, 1106067014798350615927217102906143728284947422919683789305115030542224457597587069415871320345978799780079529450233874789484021115678026572047820538798245347120417607202997542608836573846026476288590333430897006063626600454762564430841812407750492571123522186912042780557613921069626089995480232227826549605796680704808710743263278189502809360912939643535180461162735232129952369604331607873458320792545735464280552510726527244568838247911806219340326420290817038553864368567592145616654281195849606642440302415726691838235416021652864370075790302074828721571496669222987796414063787223187968002229296552036989773173, 6581168648598475069584703601691211288156112055862348588878619619206085753267151745295249618094072716884864714511703701368795515578736605340365735832019744122302827857432937026680880623526318597844834876524096005822808914373198241607227429327904059187217499468417025321995642598974461601887526695850163578204743740931761195542936373125679456893073175748159372362148303326630472323351551671421951472412887364701893206399937003251935217091960393294724195881569822446122452459801953420918226188775048995400181440311547003628939568924952998118481462954727082581996166504460076161354135868494006193187959304866609089790056, 7392461648955641519651052631330207669271999163026564266131563580610917749374913198325527408060359989203258858610205690240581647680264078778457141014961905465668154632658823176115392976907828572809589029373557463951700830665974866341017446345735021098079865330461783484660646909421628773413934035256818712337784454055872556570843360925313814010091867901470149985967568305454699515813578241272789740343427656406753114609667835243939309169753317726686404543246203955735553689053909807432373170113318906561508141505612307512366029900184364695182728479329321203884515615859223844265115924675824250250518929133435016082671, 8781829859330208919799823372737727224694242875564168069886789609922157032011799499078021581240082433520971835953863760739895697874048662348732093141887437961847722329735862361027217020109877340517127192371625043473007958856277312752597349485120444607112563094145087376445305326409105207817743236663975884943907893573814492217958687876250365587732280811009422876215223659711573963894537609464544158217155375077085398184944483289198604042059511170378217317120465739343818511413998862336271314142915275664987431356410297519317913726233479641477287418688237038154933812778910924677496928929725617104417330763614935376175, 1396427518861299824567139629667242160098766494744367993485983164805802177309144629199625935021980787059942172798711183961693607631393078985547790924298957173782487357238828669616805724620206508582286337828169488779689336716659528387793064418638020170005296892320188490201435472827041283590979976924919445341047969899096778199767515573199997595776054332701986628197159735244938712845527671465761497806797194205968660072078940735001279297644605608870081991992161531608901697621073501515376551517707152205048602466379568380100627391108740361128667491957560750021717788090810873294498109456070245032865649591837056388894, 8545986646314941026575481181573137784712166796675053759873251648583676853706778802356935991288282732900937100540503452554423487246584286307876886354429240581172362594723102739660032310882791204671503436349103072771197907569343613357360207094715067245335847979462527813848244327382633079529069698089622816141723031896207033899067737384214188126189602326275965069631816504714788556505318468857195742439328062641073957446107517960347910276435758648176594731415407158532892827369861349026980153300600620047713712484257902812225307372524015386382854483756182095586161049743069296353707936062889885652877624400305184851897, 2361133982929721055593598207410006972527906665452904331410893748873916201130342178812093965259477894746032883291631545061140608216035657821545183455084361273752028097542213888803628251907176965960210166928190541075059009022341425238201708953223154395150370918095770641060956896412569903721836344098110754029211490226517404678922209856882138462993366557830591839871739098646109617597195876026052633935989690146560755760505077239133970739416740271542186551326962556460165820209753630626578614161123593074025862375977643695687779128645478535319548117395299670773786033987518127411366327911783980236955267529696730627213, 9375814575138467696256872809420131296637862544727918975568803576962403618417010268011349350785312830661562176292545194362332635577931415833109614745823817115694412885288887882913487665385631680900678712993432085572871504496427526156310660612275508339953932919381089017868822210460518245022791883333691945861139512726616322230538674033740070103240590211943172789853921016887129200259834924229074908127991146634163403602744815618324394530099964517084218558459378186081576512559001421148471819689037158003748253394557676420939485847556557803176519845734819361875388608234586599371673941223441114870623408493001290615509, 8308761698390111680833405241699085087572235572072361315397557624054745710583767423118348460413772618827342362488963366145697251726050207394425809000849008316129205969436768630208288557026094663518221432150842607791236626891306053603710827607441450726166288460180953478992389575270743803168077484178253871571305444458274304429212113398569718992538434560995004090570835870274973043123183473590552003324592013081048652024980396284191515165283463268257325769351888934897051790867965859527288243860745657183073531205869391128515252256581027877228303938189933277804958055364864176200742325692741081492221004217550070219930, 8915670081134064504845563141959788358816307762940715558626578651303490990773435391699156538127402573154125479936162336993133039021493002397846457850172920042279838951238210420530196660619000713853050288259665561719683661052830694189558355329761137583869646064452666014210660376864962975505964989973265006755803819108529167317096827024643523403151559357144888925568965097820728308983468167900199634533891264398515881144857302791548024309883656684053899697902723603401692389479299883210470783621017145253563158135777331659894598493956902154331504865392210609066013572278088892355478438247491729533561386728514861828292, 5328478166895613760877865157467141869063643846911042098147584778492950453223788326279775102224522591126069164308156360272411289418982585186639649362883321288916906644010468170387028466304162336404124250556154919137612830805797955523533559651234268637451181724873088496527563095112970025591726696837145056519670016729744906964342827262040905085607400950377916697673370600617818753604909429923934783628701202597044337609669459665155577462348155840153424723355838173501427734293817022592084922746297896412321654443760298151528137336605731407026118562144956008298497749710237118440581641201641097379451735198643297731163, 1212653620073645815350960381319229271546400219376824438834553762759283225062621438771990152917129514273301353380134045009385006670573960429774277074218823820622167150021772194354063764541309837322124544286586992893133075430816080113357293175701713162205038778539115718271593502333086687013237608010380138799036535301426476280181150057444199809994604802240944475962746526212833786427090243971249850405731981907580018856683325581107315146535207440730281015366338808364870855604265742325842143615529584711083123066280766640032998459200272497928002926950039907205824368669951799525183048191627417171090866583767212230461, 1020978286804405083407541068924500748894560900831871816441297414872155715389557790352950303616652689174289720195568061505185085377819647499648184259155887240781800913637215286263986126575336422310238477840605755822730604027662175271559667112552938453987744820883866428836376071282094327158959283410381096702513258812738061646285517159839916868524876730445685077243994208548005532502639440722137827346487624964980310928105951480312057110919096126947387868472860406542012729947668721657777685839781378204760700239129390354359870959909858462748358479799073738808134602394178422034873983506095717239714811063585408622513, 464396070787320054175723338762304754305074474834155046680548965383228315920729060311493511447388781557499221239346238768201238013466749879398816225464728965008708020397856874819829983097794993132228322024382839915674092492926448606679203561800745272873762073010555092908570635848737134469257928906098703430914397195484264704048480142031668566586965875823612371816853261105679574304728084154529929558784713785635884731502078796986282006360704761905822075687271162294225120875243218202494496516434212022487107854963720220065881001453111947898471222255254946081603160320080857546056523162849320138736767079344966835671, 862189194650447213939938258024805367909646863745283393074199776085885386089342087388174547876457849516031741617723292779846055284255673800145164640066086873642353608433602154044497668799724875808344902916320651252037552156872798240962033487149467966726819461669761547250710865662349093228865031217950950894230021123008627782017864582719296706288866576624258831595715391113099580802745492201122221880561356928814934691958967992924712518956147709460573250032121829584533374305078863322829816741799349345514800548228185765107631516419921201777985266684996331171853318300989961446721569925142160413503543941472736582980, 5803317072055585778967212921932108474722481671979969737732533686844398223423851890154844251354394930321985071442391017689375063250528789494802843379820063733308697037181011626257050197889548947911210503509323358299113872038483183209931002810015970163102825854339636982938200766386725342355444940344004742209354984407498058463443726451262464293033038731592703805825779471184826242407644260632264209260759086907445857452298353043240477413989120920040819056436513555583836047228647333638102920683080042971007295712201516365752310388936747383449510139964719167509508913854456291051168793017988673001406321783557287347754, 5584217283388347192311379656186560572529807094588479882680602775701791412161807722057436895061688027057505159385445412208290263197398650807660956446813097360036507638285671709170166142920089957931027891953786175982475035752356804943010365354803499504977091668344519370506907389114407961682822922282964336255637538517174763247433886466098876026362495277119954484891985938793606110585062665243394747908085699572518882677112032977268523542200251529615755935640113872984115904315272136141003170321007880124366487108446678911588535594067387183340037989216386025159894792391129055235363662366387370043996332804844329400755, 4516300657361266344062290690050891035344296201496195723150218119017141204847306717968153892561254528013008557286820097167230804572552500944212256500980004523618950703605657301090954086016067547735030905634182782790807956780127463775254451174255834024081505116579147884765132743730808397231124183736208771119422038050333901483305058904449175975137707180416931269299115684567469334719750177675134418791118833865745618188835052519297379013819896088619356955831586052155331659137456099639919006311163957030373897523749757244513534754561291303186272616840306048046372711855075783160851057286470024744715931367287826450791, 1977603645642068222205492057162675909012447368044433982895380419813742621943743664565843517782624547860499146604088289925532332694916792395123861300008656391276359871241969268543864753234522491983302388478333632948522967830390614007307291680101499328913139582612429915354251555185241872739910055784064622539139089964819580731545570431140121477674022352238373040425265595197999240027094007270904813618377171204957537409948770763141675454733516420020990130451421462457510276964312270640971198614414701145582205789374110332337693496641724758414000349967667300233716726514339421603787153476189443587909016729991169694086, 566090189232449298670807619918829825548829049905304141654380474449066641221139020644634988369385824042705921534441993275043399942688789470483910672260414294703393474440132079372117801234616355141102999792732715607376603414958260515117970283132064954024274349472163929004756177415444783311118244023242008238571507916861853468170961709972346018147464245808824687024283709973286451581137357900158179910406323943086137262243752204191869940863308168511864657073174026905579485294931044682418826272738690583415072008637743066790164705450909516265649594899179316060782066704555585755197363856816960685894513342352300790064, 7558080618425525590552669577430310484015060547189995370754615843954894671077980616599956177694692275795129074560806791198182369262809897363378344410521100968212646721254079793449988433908707608805619991758287427682855877987357642691961647654900659119640047366170329177544844945751877986208124021782836420194283329600971240417024780844420072210979343373639224044200799046013469972810920604700915654050933393073127208930713166670293644264609227340374306560620985274071173616848642545775359354752640922159641750235339511591903102754515262326272572716168019663331231870304925090379575366747375430124389697634141375437302, 1856662514414026601747067012061293455611027609628095755849342756443387010528551854097281372155990041160543961209069736275885008102855126188508257636357373770115626967246206806121315758765421581606296278591606827304481179404352512213419756042867701704566783544593588113249386822954997178981303985727486713865523041187998826974435023526589225072027585058899879426268234102471344732523973742874716396124662280595379148509807607006672285805278854595001145021370592091059674729617757464348868522231052169762118673652171054979589289290053638654131643784579397688317406820345540449890443886700738085943088319414506126677846, 8791459524629760243426192078357794246224532223324603147666034863980934872701166900273665445352874342507900779376666320671636289493534007520708288096151408433617134166674568549908473315545113373968190807879684960994151926192993540310303419813366704541860857431804549780153742016887602187812960156669344454542422794303154271524446000890469134124970078160525389386067673393533276660949167270915206532878186502052488538474269221594294795658910106160220181388582730611967278193757633264637486581735531251745661624837059626797575543288293359402787368398386903563737590768797584148687962570654202213036730019491340318335848, 6548518601180077725371124373598425917111137414331496724308360593883686798499067485337731080479035753419191184419785906032488830550435061709775282756715813775365808352118026143904815228825879051793605916673568966833605003776637381337543357856875339371658913752123772796907466053688691187610254680038630051910966603538632420626229683131120115589406655802291940316773809219961293474987836049134212613005445754958175672468781338330825970129175205748753760464671827678922180039726878364285103280520321388177811903715423377535399792204589699275960417245820478068351217912277810744009721047869714432032679976514090412095432, 2248839959787569039426241429077241043885033177253253421906621148264825890126824762057927598277558468120973418250950410177352133273251769784414277087604366906572988778597702158069444414622152907984004345166269636552813849659714625547346549598039835914749039658098413114407741900232523517938721002185305614983880836105481354820308628368990102978904022941417050549804068279530502409374955954725435609678901463767180372338796337250086847092770915197087955437262674968637708723928655066845846211759913145469763869525882745991320359219378922872048168513168419772713186045620372860354880910345524581769560852971012857276802, 7267754155483653761093971708393481119417198413844072938415590387473991668199979443688876691444391614262307678456963335079590606238432590746399041281067935333351015487441543812524189487043533021798736155113787267243229112542067995910655267684312304393064628884917480264128796131808258439083378454194060060565553723313980403716176763289288323996885590705856535189230599994698010037942053126960017832893959918748594072606287118704537310468651246284456045552008763290965442119454127303262718748606007058889312747510503524855083247221469741308042391902580097752127206508102734664546915651314737053889468115772814109155409, 5751127719872783359584194389737572411549853749300317958530142013085271064569555121420028297084658201351561628893314794619042823962990241416286949654001701448832617714900332694784577860454155594404935590751579587348917213617009700526759070554897149612138557881403186173886079824718316518614878420097352398940850383360098432658606477758857245828805420375880866051373330379221590256847744727622923285627789176803462883347152880565651876755095773857158319616802838864434511249732384103160281291773643257957904927996505294408716094291677339631803196039070462571097897245473515696248380689571866590318328941265701875628071, 566090189232449298670807619918829825548829049905304141654380474449066641221139020644634988369385824042705921534441993275043399942688789470483910672260414294703393474440132079372117801234616355141102999792732715607376603414958260515117970283132064954024274349472163929004756177415444783311118244023242008238571507916861853468170961709972346018147464245808824687024283709973286451581137357900158179910406323943086137262243752204191869940863308168511864657073174026905579485294931044682418826272738690583415072008637743066790164705450909516265649594899179316060782066704555585755197363856816960685894513342352300790064, 9300645257166889251173462956422260436524277389137009207273648884751658778758241901144244237045017924895179288273059950041474527208531507241118636719629925406928900882721275746996512430153156265167292690309712023718763612352035153111888008576399074006115541150690378315494066918272321451023535683267605183592044116396576329333707195733504889891862110121465786316510496816311672996196728538762932425877341937784846139000921610440657793803492131074832334058907699009216567464332902930283298769491572863490708579688707732953384660617002458198352090806160025757106415549037666836153125601764497529499487278905591848995873, 3568516864121458398362588641874336282515483037549812791298864911492186846189210162824643841683988375949781996498581892467763612828194633076113005838764461884758612215748820684056187959980995766847698835147462308350309498741579848748224999725671860289566152866608469828357680308264496893876284291051023394699751386285931159668347961879011900293949361774793253489303227495458559992897683942840282981684896641064730725428816189189258730813121256785262640462938323104660414905479167180403590704228941698927463621521152501884888753845250907065613542458349759398966286832827416408436437402014254340628751089074308814732143, 8482731781705292924718590679404533179939353538242383772405401593269222760328429788232292081425953309228617516933335320964557755099589582875396387783258261070981840935888742388035494501235904945331378261952632781830798408130041480144369336326681834253956639163866248186395081267568444007261227198265860499308687712996923997497291445518993104783544429071281868006531960330801760811751375105591294203508460854987553113462766570426395858966880886080902149349698335051382708610586257464863239897056400111474017256985295026885140284456346856899489083059296635885451266117962802700193037452461443451318880069863228547040840, 4509388777310807841487278255276145401865412513311299664102899880157045328105280242965479589281804362978058526283086602394843514421116565909518196462742721135495215100159183397149860009091229324889198559780320246884919106707066339299312101089155182901232680873973731138415685383411859090311460407114405838700888383241954403251839458867820871574250976175454657117113451073953658984060796839807512153337954348307237057502479168135214905657901413792548617931435128993808233646688447913813305645485077993446339064860074827653389655379158770667226457004494064376921466644862888356869195806830748797546220421600979071882763]

n1=9672542900942760673859375439906894206650044215137915294095527099674783857628898127761941274957237815087065939424636491853668015314387746574209401926049189238846458221979083881422119469847802702463077675662191276424276833093696369361141209618162406785552878361752577366513101313320224137072224529421059994337757945050598836416425970452156669964360937395803483802988162108381606525216524156710068414505911871052631539585509158725297793715746341671843616968222976204596671485714217783515536540196161299971541100623284536491583073282646989999230175613937525019756244448335597468255248656884733842734332349328482604465581

e1=4202312174163608176595853285750254438291211798910349003216925804507201436437375034302025656469305127347106799372803621409106097626337684796540159520242017403419612665655741752958398530042979517895848416884439457244706316693303178795785812650335878624707613976976511649725850856608988462977806117450664915367458009460374941948212173548221111075597486977568506025330045212530187403520036327756833780998392700190035781167624432466615876744514614706166113088508607362517767455938666423626810232306650842516568629095773569667999141768685597093401605395220053752870444598530712215677203851694896053514556330182141027446079
####

# Compute the mean of the distribution
mu = n1 / 512

M1 = []
# In the worst case the cryptographe is born in december, meaning a std of 12. In that case 99.7% of the character have been ciphered with value closer 
# than 3 * 12 = 36 of the mean. I limit the test to a deviation of 100 with ensure 99.9999... % of deciphered but avoid infinite loop in case of an error.
max_deviation = 100

# Iterate through all cipher text and try to find characters that could be transformed into the ciphered characters
# Start by using r equals to the mean, which is the highest probability, then try with mean + 1 and mean - 1, etc..
for cipher in C1:
    deciphered = False
    deviation = 0
    while deciphered == False and deviation < max_deviation:
        for m in range(128):
            if Mod(256*round(mu+deviation) + m, n1)^e1 == cipher:
                M1.append(m)
                print(chr(m))
                deciphered = True
            if deviation != 0:
                if Mod(256*round(mu-deviation) + m, n1)^e1 == cipher:
                    M1.append(m)
                    print(chr(m))
                    deciphered = True
        deviation += 1
        if deviation >= max_deviation:
            M1.append(-1)

Q1 = list(map(lambda x: chr(x), M1))
print("".join(Q1))

###### Exercise 2
n2 = 15351080706684177709033943010764090976629488121574052338075238072391924716522874652796383398624728674634580322020728012501367730093140837727056083869232830597458921802560695905031569216239714018536354848667700449084246719984592303140774576250523927279439005222199834177469835584710856015814110673043383728296193172181750174444804069971715112887121444470409064711203345217545099253909687641527359057504573647661866388360186683911709837534015868227233731992934751512557371647570341124052325175610811444956378330151335734386718196995790242707352290888716747476184279992910144569224038077912318868173946174882221649822827
p2 = 144438736423621606813981119830779025092669916737567027423332754415786403645052464444793922036561882718601969197314632134508092216115538773601182738057307241219490660016271647745045325449333005348754454780364021447163250713170950092743445972064522244233685916198779394557027596186021872167447036865150036551059
q2 = 106280912494701468339991457228929365598944004571603101494281489355596467402138233801176843953269944276940122627822987595670776166272390282456703878029055052134005491559068732810665656316609151964279536867092954403261387672621522942210571897623592549143327122635256351275268692653612634923254758448068285361353
C2 = 468846609608077935453234078596445555107052266903943521405796362867008662172812305322755597560706529740501779730810824947073434216106615915375035207412478215152347296363357159816233536150386885242478400928715994921647409441061623390917304072632351646564629580290103096479845385964562381797778779377974466241215768456767915659553191779216
# Computing square root of C2 in Zn (slide 304)
yp = Mod(C2,p2).sqrt()
yq = Mod(C2,q2).sqrt()
Y = crt(ZZ(yp),ZZ(yq), p2, q2)
# Verifies that Y is equal to the square root of C2 mod n
Mod(Y * Y, n2) == C2
def int2ascii(val):
    text = []
    while val > 0:
        c = val & 0xFF;
        val = val >> 8
        text.append(chr(c))
    return text

Q2 = int2ascii(Y)
print("".join(Q2))
###### Exercise 3
n3 = 23027205674734584467652988369542395244938135632907779958323878171156123309337484000575985240761917782610553924839502611279429721904209087464533809729817930874550330580792037152177323224273693965888272564766796707449097329118885186259883522120229913432543842452768747051015748174182689252379268496221861261916566215471355294548727226759053415013467910262219690398911702182032412108524828535194861079300967361487564787598122689281374519865814747910696751462135978645016913555741835074874249259140141271699606755804207461304341575920994162941209163052995333287662566328838844197777557899496752547324546867304104186563271419
e3 = 3
c3 = 10645942755631715760246321834493293094870324136980548238181637623447360541650244381961571636687918179184282001418379746364172046127108216391163945492069287150387791589250652109992012193721520752326957011676763859357453485155883639038283483848699609147363306743437250053004889559665577632994061063185237213605227622432753487462223263030523576759853656066436105717196374520607797079263540373129958313541697789368220674592012485411173990443779035378987833464511591228144984821383245400254509777085668858368643522802771533437351948587390904624255602331119856847060148238205185141930867023812414913345558407765873255684790928
# With only 86 characters, the maximum value of X3 is smaller than 2^(8*86)
# With e = 3 we therefore know that X3^e = X3^3 < 2^(8*86*3) = 2^(2064)
# With n3 = p3 * q3 and p3 and q3 have length 1029, we therefore know n3 has length 2^(2058)

max_ratio = ceil(2^2064 / n3)
# By dividing maximal value of X3^3 by value of n3, we know that X3^3 is smaller than 92 * n3, this means that 
# X3^3 = k * n3 + C3, and therefore that k is smaller than 2^8.
# Therefore we can simply try every combination of (k * n3 + C3) with k in [0, 92] and keep the combination with exact cubic root
candidates = []
for k in range(max_ratio):
    try:
        val = (k * n3 + c3)
        root = val.nth_root(3)
        candidates.append(root)
    except:
        None
# There is only one candidate for X3, we can therefore translate it in ascii
Q3 = int2ascii(candidates[0])
print("".join(Q3))
###### Exercise 4
c41 = (25106751973998650972715774295595662240602253205272811935960951648440453142924313023223025860328828433066805896382642340156708721160172824813382641809252094403221796278595823691673345712735365579289720625107298735123185791017628790799355197352740438006541667104753772503708578149541420181434452621439899278870, 16065321346104523383937302431611868747073271636912740199987983967230552642453661108516456400025315740775226058954927226959980321739642378985811391308549940831861899563671158096323726732946433054061256524089780661853880083897810097358537756498351648999763684549655722791002011645904842343359707112284298439919)
c4i = (35269888698099689946051716962880219900096128479499630453072314859718724646350396984926037099350832967592611691831563764164902145978779302772871097702269384029228621067055731907935541747308523564834696985752247791725033060288450677885931858153568121429518838403750814663410380605821866998452662502343097547048, 8653798247119570861859939202048772553674982641280844191789593421935819871208731820205669885750396772855828609708043657473448894275672377458009520996337954399185467559303729044733695286290563268967226712590756287085393849040458003327532355077692250561755247982950991291867720274715607867283157762992614390900)
p4 = 64245208673810635182765239256208926803287100359302749446809556207105745543535653262736664336722271095048611145771261969446694464424230052352705842599478851287504349750480733672081799685255474554360211140003191855514214337538226647744024540218971283942679831829546740458613328431774392153674372719025615264383
g4 = 38040578073572018515696004852865910566651480243638588660670216117160570939342328842660102377580169375177736233418698876483030468904388936540852120675510177806073716847168965684192709202686576656631994224024615133790662732667677082218111228367923258450229879554219846002899373668617292929797547946845215162590
y4 = 20863690877689764047089003352144909471284635529908560724892423410030397362348060066195512821395589296989950346159978303197914795498200936033649177305943813922941560745304561560020007639614160399814541487681549972845842407224043888817025171615105585572226152923234956121488821060584365378048424498100676308699
def ascii2int(text):
    val = 0
    for i in range(len(text)):
        val += ord(text[i]) << (8*i)
    return val
m41 = ascii2int('Hello World!')
m41
# We know that m41 is ciphered to c41, more concretely: u41 = g4^(rinit * ) mod(p4) and v41 = m41 * y4^(rinit * ) mod(p4)
u41 = c41[0]
v41 = c41[1]
u4i = c4i[0]
v4i = c4i[1]
# Since rnew = rprev *  at each iteration, we therefore know that u4i = g4^(rinit * ^(i+1)) mod(p4) = u41 ^ ( ^ i) mod(p4)
# We can then test which value of  and i work
for i in range(21):
    for gamma in range(0,100):
        if u4i == Mod(u41, p4) ^ (gamma ^ i):
            i_ = i
            gamma_ = gamma
i = i_
gamma = gamma_
gamma
i
# We know that v4i = m4i * y4 ^ (rinit * ^(i+1)) => m4i = v4i / (y4 ^ (rinit * ^(i+1))) 
# We also know that v41 = m41 * y4 ^(rinit * ) => y4 ^(rinit * ) = v41 / m41
# We can therefore combine those two equations and obtains: m4i  = v4i / (v41/m41) ^ (^i))
m4i = ZZ(Mod(v4i, p4) / ((Mod(v41, p4) / m41) ^(gamma^i)))
m4i
Q4 = int2ascii(m4i)
print("".join(Q4))
###### Exercise 5
Sciper=252556
p50= 12200161807400769987436101994196488884037912773423439164285667135912262107128573107909884641975290386064869510399604035387690756807028470160253466485780269
p51= 8482212619827595645619056856655476134106292153259371931087691697954996080229977179622402650666440647036834639031945675753465645499581209294109304522424279
p52= 12268772751370891055409640540344507841055525784617926056219534938456120780555211232770408724922287774029086970527483173118762945540116358971944577139012611
p53= 9490119548510635075273550697469350098974654876275816620219271964428091411096514110101507245804206889328239716071785748785857560844681496802892281344959379
def B(x):
    return x^(ceil(x / 50000))
# https://en.wikipedia.org/wiki/Quadratic_residue#Composite_modulus
# In general, to determine if a is a quadratic residue modulo composite n, one can use the following theorem:
# Let n > 1, and gcd(a,n) = 1. Then x^2  a (mod n) is solvable if and only if:
# The Legendre symbol (a/p) for all odd prime divisors p of n.
# a  1 (mod 4) if n is divisible by 4 but not 8; or a  1 (mod 8) if n is divisible by 8.

n5 = p50 * p51 * p52 * p53 
n5 % 4 == 0
val = B(Sciper)
val
found = False
while found == False:
    val += 1
    #Check if legendre symbol (kronecker) is 1 for every factor of n5
    if kronecker(val, p50) == 1:
        if kronecker(val, p51) == 1:
            if kronecker(val, p52) == 1:
                if kronecker(val, p53) == 1:
                    found = True
                    Q5 = val

print(Q5)

# Compute the square root of a number modulo (p1*p2*p3*p4) and returns it if exists, otherwise return None.
def sqrt_composite(x, p1, p2, p3, p4):
    try:
        # Computing square root of x in Z(p1*p2) and Z(p3*p53p4
        y1 = Mod(x,p1).sqrt()
        y2 = Mod(x,p2).sqrt()
        Y12 = crt(ZZ(y1),ZZ(y2), p1, p2)
        
        y3 = Mod(x,p3).sqrt()
        y4 = Mod(x,p4).sqrt()
        Y34 = crt(ZZ(y3),ZZ(y4), p3, p4)
        
        # Compute square root of x in (p1*p2*p3*p4) using CRT
        Y = Mod(crt(ZZ(Y12), ZZ(Y34), p1*p2, p3*p4), p1*p2*p3*p4)
        return Y
    except:
        return None
# Check for all values if we can compute a square root using the previous method
val = B(Sciper)
found = False
while found == False:
    val += 1
    #Check if val has a square root
    root = sqrt_composite(val, p50, p51, p52, p53)
    if root is not None:
        found = True

if Q5 == val:
	print("Q5 has a root: " + str(ZZ(root)))
else:
	print("Incoherency in Q5")